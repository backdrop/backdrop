<?php

/**
 * @file
 * Definition of ViewsAnalyzeTest.
 */

require_once BACKDROP_ROOT . '/core/modules/views/tests/views_query.test';

/**
 * Tests the views analyze system.
 */
class ViewsAnalyzeTest extends ViewsSqlTest {
  public function setUp() {
    parent::setUp();

    // Add an admin user will full rights;
    $this->admin = $this->backdropCreateUser(array('administer views'));
  }

  /**
   * Tests that analyze works in general.
   */
  function testAnalyzeBasic() {
    $this->backdropLogin($this->admin);

    $this->backdropGet('admin/structure/views/view/test_exposed_admin_ui/configure');
    $this->assertLink(t('analyze view'));

    // This redirects the user to the form.
    $this->clickLink(t('analyze view'));
    $this->assertText(t('View analysis'));

    // This redirects the user back to the main views configure page.
    $this->backdropPost(NULL, array(), t('Ok'));
  }
}
